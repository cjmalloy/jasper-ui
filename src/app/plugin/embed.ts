import * as moment from 'moment';
import { Plugin } from '../model/plugin';
import { bitchuteHosts, getHost, twitterHosts, youtubeHosts } from '../util/hosts';

export const embedPlugin: Plugin = {
  tag: 'plugin/embed',
  name: 'Embed',
  config: {
    generated: 'Generated by jasper-ui ' + moment().toISOString(),
  },
  defaults: {},
  schema: {
    optionalProperties: {
      url: { type: 'string' },
      height: { type: 'int32', nullable: true },
      width: { type: 'int32', nullable: true },
      params: {
        elements: {
          properties: {
            name: { type: 'string' },
            value: { type: 'string' },
          },
        },
      },
    },
  },
};

export function isKnownEmbed(url: string) {
  const host = getHost(url);
  if (!host) return false;
  return youtubeHosts.includes(host) || bitchuteHosts.includes(host) || twitterHosts.includes(host);
}


export function isYoutubeEmbed(url: string) {
  const host = getHost(url);
  if (!host) return false;
  return youtubeHosts.includes(host);
}


export function isTwitterEmbed(url: string) {
  const host = getHost(url);
  if (!host) return false;
  return twitterHosts.includes(host);
}
