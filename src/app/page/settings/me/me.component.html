<ng-container *mobxAutorun>
  @if (store.account.localTag && editForm) {
    <form class="form"
          [formGroup]="editForm"
          (ngSubmit)="save()"
          [appLimitWidth]="form?.fillPopover?.nativeElement || form?.fillSidebar?.nativeElement"
          [limitSibling]="true">

      @if (store.local.selectedUserTag || config.electron || isDevMode() || store.account.localTag === '+user' || store.account.localTag === '_user') {
        <label for="change-user" i18n>Change User:</label>
        <app-user-tag-selector id="change-user"></app-user-tag-selector>
        <hr><hr>
      }
      <app-ext-form #form [group]="editForm">
        <div advanced class="troubleshooting-section">
          <label i18n>Troubleshooting:</label>
          <span class="buttons">
            <button type="button" (click)="clearLocalCache()" i18n>Clear Local Cache</button>
          </span>
        </div>
      </app-ext-form>

      @for (e of serverError; track e) {
        <span><!-- Unexpected Error --></span>
        <div class="error">{{ e }}</div>
      }

      <span><!-- Buttons --></span>
      <span class="buttons right">
        @if (editing) {
          <app-loading [inline]="true"></app-loading>
        }
        <button type="submit" [disabled]="editing || submitted && !editForm.valid" i18n>Save</button>
      </span>
    </form>
  }
</ng-container>
