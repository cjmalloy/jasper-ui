<div #tw class="text-wrapper" [class.mouse-left]="mouseLeft">
  <textarea #editor
            [formControl]="control"
            (input)="setText($any($event).target.value)"
            (blur)="syncText($any($event).target.value)"
            (focus)="toggleFullscreen(true)"
            [appFillWidth]="fillWidth"
            [appAutofocus]="autoFocus"></textarea>
  <div class="floating-toggles">
    <button *ngIf="fullscreen || currentText"
            type="button"
            (click)="toggleStacked()"
            i18n-title title="Stacked or side by side layout toggle"
            i18n>\</button>
    <button type="button"
            (click)="toggleHelp()"
            i18n-title title="Stacked or side by side layout toggle"
            i18n>?</button>
  </div>
  <div class="floating-ribbons">
    <div *ngFor="let plugin of editorPlugins"
         [class.on]="tags?.includes(plugin.tag)"
         (click)="toggleTag(plugin.tag)"
         [title]="plugin.name || plugin.tag"><span>{{ plugin.config?.editor }}</span></div>
  </div>
</div>
<app-md *ngIf="preview && (fullscreen || currentText)"
        class="expand"
        [origin]="store.account.origin"
        [text]="currentText"
        [plugins]="tags"
        [appLimitWidth]="$any(tw.firstElementChild)"></app-md>

<ng-template #help>
  <div class="editor-help-popup" (click)="toggleHelp()">
    <a target="_blank" href="https://jfcere.github.io/ngx-markdown/cheat-sheet">Markdown</a>
  </div>
  <div class="editor-help-popup" (click)="toggleHelp()">
    <a target="_blank" href="https://katex.org/docs/supported.html">LaTeX plugin</a>
  </div>
</ng-template>
