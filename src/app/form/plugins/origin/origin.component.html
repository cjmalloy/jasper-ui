<ng-container *ngIf="plugins">
  <label i18n>Origin</label>
  <div class="ribbon-margin" [class.on]="pullConfig || pushConfig || tunnelConfig"></div>
  <div class="ribbon-margin" [class.on]="pushConfig || tunnelConfig"></div>
  <div class="ribbon-margin" [class.on]="tunnelConfig"></div>
  <div class="form" [formGroup]="config">
    <label for="origin" i18n>Local:</label>
    <input id="origin" type="url" [formControl]="local">
    <div><!-- Origin Errors --></div>
    <div>
      <div class="error" *ngIf="local.touched && local.errors?.['pattern']" i18n>
        Origins must be lower case letters, numbers, periods, and start with @. Must not start with a period
        or contain two periods in a row.
      </div>
    </div>

    <label for="remote">Remote:</label>
    <input id="remote" type="url" [formControl]="remote">
    <div><!-- Remote Origin Errors --></div>
    <div>
      <div class="error" *ngIf="remote.touched && remote.errors?.['pattern']" i18n>
        Origins must be lower case letters, numbers, periods, and start with @. Must not start with a period
        or contain two periods in a row. Use'@*' to match all origins.
      </div>
    </div>

    <label for="proxy" i18n>Proxy:</label>
    <input id="proxy" type="url" [formControl]="proxy">
    <span><!-- Proxy Errors --></span>
    <div>
      <div class="error" *ngIf="proxy.touched && proxy.errors?.['pattern']" i18n>
        Must be a valid URI according to <a target="_blank" href="https://datatracker.ietf.org/doc/html/rfc3986">RFC 3986</a>.
      </div>
    </div>
  </div>
  <ng-container *ngIf="pull && pullConfig">
    <hr>
    <label i18n>Pull üì•Ô∏è</label>
    <div class="form" [formGroup]="pullConfig">
      <label for="pull-query" i18n>Query:</label>
      <input id="pull-query" type="email" [formControl]="pullQuery">
      <span><!-- Query Errors --></span>
      <div>
        <div class="error" *ngIf="pullQuery.touched && pullQuery.errors?.['pattern']" i18n>
          Queries support AND (:), OR (|) and grouping qualified tags (parentheses).
          Tags must be lower case letters, numbers, periods and forward slashes. Tags may be qualified with an origin. Must start with a letter or number. Must
          not or contain two forward slashes or periods in a row. Private tags start with an underscore.<br>
          (i.e. "science:news", "science@origin science@other" "your/tag my/tag", or "news:_my/private/tag")
        </div>
      </div>

      <label for="pullInterval" i18n>Pull Interval:</label>
      <input id="pullInterval"
             type="text"
             [formControl]="pullInterval"
             (blur)="convertInterval()">
      <span><!-- Scrape Interval Errors --></span>
      <div>
        <div class="error" *ngIf="pullInterval.touched && pullInterval.errors?.['interval']" i18n>
          Duration must be valid time span (HH:MM:SS) or ISO 8601 Duration.
        </div>
      </div>

      <span><!-- Help --></span>
      <div class="no-margin">
        <span class="hints" i18n>
          Use time spans (HH:MM:SS) or ISO 8601 Durations&nbsp;
          <sup><a target="_blank" href="https://en.wikipedia.org/wiki/ISO_8601#Durations">help</a></sup>
        </span>
      </div>

      <label for="removeTags" i18n>Remove Tags:</label>
      <app-tags id="removeTags"
                [group]="pullConfig"
                fieldName="removeTags"></app-tags>

      <label for="generateMetadata" i18n>Generate Metadata:</label>
      <div>
        <input id="generateMetadata" type="checkbox" formControlName="generateMetadata">
      </div>
    </div>
  </ng-container>
  <ng-container *ngIf="push && pushConfig">
    <hr>
    <label i18n>Push üì§Ô∏è</label>
    <div class="form" [formGroup]="pushConfig">
      <label for="push-query" i18n>Query:</label>
      <input id="push-query" type="email" [formControl]="pushQuery">
      <span><!-- Query Errors --></span>
      <div>
        <div class="error" *ngIf="pushQuery.touched && pushQuery.errors?.['pattern']" i18n>
          Queries support AND (:), OR (|) and grouping qualified tags (parentheses).
          Tags must be lower case letters, numbers, periods and forward slashes. Tags may be qualified with an origin. Must start with a letter or number. Must
          not or contain two forward slashes or periods in a row. Private tags start with an underscore.<br>
          (i.e. "science:news", "science@origin science@other" "your/tag my/tag", or "news:_my/private/tag")
        </div>
      </div>

      <label for="pushInterval" i18n>Push Interval:</label>
      <input id="pushInterval"
             type="text"
             [formControl]="pushInterval"
             (blur)="convertInterval()">
      <span><!-- Scrape Interval Errors --></span>
      <div>
        <div class="error" *ngIf="pushInterval.touched && pushInterval.errors?.['interval']" i18n>
          Duration must be valid time span (HH:MM:SS) or ISO 8601 Duration.
        </div>
      </div>

      <span><!-- Help --></span>
      <div class="no-margin">
        <span class="hints" i18n>
          Use time spans (HH:MM:SS) or ISO 8601 Durations&nbsp;
          <sup><a target="_blank" href="https://en.wikipedia.org/wiki/ISO_8601#Durations">help</a></sup>
        </span>
      </div>
    </div>
  </ng-container>
  <ng-container *ngIf="tunnel && tunnelConfig">
    <hr>
    <label>Tunnel üï≥Ô∏è</label>
    <formly-form class="form" [form]="$any(plugins.get(tunnel.tag))" [fields]="tunnel.config!.form!"></formly-form>
  </ng-container>
</ng-container>

<div class="floating-ribbons">
  <div *ngIf="pull" id="ribbon-plugin-pull" [class.on]="pullConfig" class="icon" (click)="togglePlugin.next('+plugin/origin/pull')"><span>{{ pull.config?.submitChild }}</span></div>
  <div *ngIf="push" id="ribbon-plugin-push" [class.on]="pushConfig" class="icon" (click)="togglePlugin.next('+plugin/origin/push')"><span>{{ push.config?.submitChild }}</span></div>
  <div *ngIf="tunnel" id="ribbon-plugin-proxy" [class.on]="tunnelConfig" class="icon" (click)="togglePlugin.next('+plugin/origin/tunnel')"><span>{{ tunnel.config?.submitChild }}</span></div>
</div>
